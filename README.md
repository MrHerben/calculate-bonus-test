# Тестовое задание. API для динамических правил начисления бонусов
Этот проект реализует API для расчета бонусов в зависимости от суммы покупки, дня недели и статуса клиента (VIP или обычный). Бонусы начисляются на основе набора правил, которые можно хранить в JSON-файле.

## Как запустить сервис

### 1. Установите зависимости

Для запуска сервиса необходимо установить необходимые зависимости. Выполните команду:

```
pip install -r requirements.txt
```

### 2. Запустите сервер

Для запуска сервиса выполните следующую команду:

```
python main.py
```

По умолчанию сервер будет доступен по адресу [http://localhost:8000](http://localhost:8000).

### 3. Остановка сервиса

Для остановки сервиса используйте комбинацию клавиш `Ctrl + C` в терминале.

## Как настроить

### 1. Настройка правил начисления

Правила начисления бонусов хранятся в файле `rules.json`. Пример содержимого этого файла:

```json
{
    "base": {
        "per_dollars": 10,
        "bonus": 1
    },
    "additional": [
        {
            "name": "holiday bonus",
            "type": "weekend",
            "multiplier": 2,
            "order": 1
        },
        {
            "name": "vip boost",
            "type": "vip",
            "multiplier": 1.4,
            "order": 2
        }
    ]
}
```

- **base**: Базовое правило для начисления бонусов (например, 1 бонус за каждые 10 долларов).
- **additional**: Дополнительные правила, такие как бонусы за выходные или для VIP-клиентов. Каждое правило имеет свой параметр `order`, который определяет порядок применения.

### 2. Настройка сервера

Если вам нужно изменить параметры сервера, такие как порт или хост, можно указать их в строке запуска `uvicorn.run()` в файле `main.py`. Например:

```python
uvicorn.run(app, host="0.0.0.0", port=8000)
```

## Как использовать

### Пример запроса

Для расчета бонусов отправьте POST-запрос на `/calculate-bonus` с JSON-данными. Пример запроса:

```json
POST /calculate-bonus
{
   "transaction_amount": 150,
   "timestamp": "2025-03-08T14:30:00Z",
   "customer_status": "vip"
}
```

### Пример ответа

Ответ будет содержать общее количество бонусов и список применённых правил. Пример ответа:

```json
{
    "total bonus": 42,
    "applied rules": [
        {"rule": "base rate", "bonus": 15},
        {"rule": "holiday bonus", "bonus": 15},
        {"rule": "vip boost", "bonus": 12}
    ]
}
```

### Параметры запроса:

- **transaction_amount**: сумма покупки (в долларах).
- **timestamp**: временная метка покупки в формате ISO 8601.
- **customer_status**: статус клиента, может быть `vip` или `regular`.
